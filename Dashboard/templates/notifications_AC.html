<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Th√¥ng b√°o b·∫£ng l∆∞∆°ng - H·ªá th·ªëng Qu·∫£n l√Ω L∆∞∆°ng</title>
    <link rel="stylesheet" href="../static/notifications_AC.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="container">
      <!-- Sidebar -->
      <div class="sidebar">
        <div class="sidebar-header">
          <h3 class="sidebar-title">Payroll Manager</h3>
          <p class="sidebar-subtitle">H·ªá th·ªëng Qu·∫£n l√Ω L∆∞∆°ng</p>
        </div>
        <div class="sidebar-menu">
          <a href="{{ url_for('home_AC') }}" class="active"><i>üè†</i> Home </a>
          <a href="{{ url_for('payroll') }}"><i>üí∞</i> B·∫£ng l∆∞∆°ng nh√¢n vi√™n </a>
          <a href="{{ url_for('department_report') }}"
            ><i>üìë</i> B√°o c√°o theo ph√≤ng ban</a
          >
          <a href="{{ url_for('history_payroll') }}"
            ><i>üìú</i> L·ªãch s·ª≠ l∆∞∆°ng nh√¢n vi√™n</a
          >
          <a href="{{ url_for('get_notifications') }}"
            ><i>üîî</i> Th√¥ng b√°o b·∫£ng l∆∞∆°ng</a
          >
          <a href="{{ url_for('attendance_AC') }}"><i>üïí</i> Ch·∫•m c√¥ng </a>
          <a href="{{ url_for('logout') }}"><i>üö™</i> ƒêƒÉng xu·∫•t</a>
        </div>
      </div>
      <!-- Main Content -->
      <div class="main-content">
        <div class="header">
          <h2>H·ªá th·ªëng Qu·∫£n l√Ω L∆∞∆°ng</h2>
          <div class="user-info">
            <img
              src="https://ui-avatars.com/api/?name=Nguyen+Van+A&size=40&background=random"
              alt="User avatar"
            />
            <span>Nguy·ªÖn VƒÉn A | Qu·∫£n l√Ω L∆∞∆°ng</span>
          </div>
        </div>

        <!-- Th√¥ng b√°o b·∫£ng l∆∞∆°ng -->
        <div class="panel" id="notifications">
          <div class="panel-header">
            <h3>Th√¥ng b√°o b·∫£ng l∆∞∆°ng</h3>
            <button class="btn" id="create-notification-btn">
              T·∫°o th√¥ng b√°o m·ªõi
            </button>
          </div>
          <div class="panel-body">
            <div class="tabs">
              <div class="tab-item active" data-tab="all">T·∫•t c·∫£ th√¥ng b√°o</div>
              <div class="tab-item" data-tab="sent">ƒê√£ g·ª≠i</div>
              <div class="tab-item" data-tab="draft">L∆∞u nh√°p</div>
            </div>

            <div id="notification-list">
              <div class="panel-body">
                {% for notification in notifications %}
                    <div class="notification-card">
                        <div class="notification-header">
                            <h4 class="notification-title">{{ notification.title }}</h4>
                            <span class="notification-status {{ notification.status }}">
                                {{ "ƒê√£ g·ª≠i" if notification.status == "sent" else "L∆∞u nh√°p" }}
                            </span>
                        </div>
                        <p class="notification-meta">G·ª≠i ƒë·∫øn: {{ notification.recipients }}</p>
                        <p class="notification-content">{{ notification.content }}</p>
                        <div class="notification-footer">
                            <span class="notification-timestamp">G·ª≠i l√∫c: {{ notification.timestamp }}</span>
                            <div class="notification-actions">
                                <button class="notification-action-btn primary">Chi ti·∫øt</button>
                                {% if notification.status == "draft" %}
                                    <button class="notification-action-btn primary">G·ª≠i</button>
                                {% else %}
                                    <button class="notification-action-btn secondary">G·ª≠i l·∫°i</button>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
            
              </div>

              <div class="notification-card">
                <div class="notification-header">
                  <h4 class="notification-title">
                    Th√¥ng b√°o ƒëi·ªÅu ch·ªânh l∆∞∆°ng cho nh√¢n vi√™n kinh doanh
                  </h4>
                  <span class="notification-status draft"> L∆∞u nh√°p </span>
                </div>
                <p class="notification-meta">G·ª≠i ƒë·∫øn: Ph√≤ng Kinh doanh (45)</p>
                <p class="notification-content">
                  ƒêi·ªÅu ch·ªânh ch·∫ø ƒë·ªô th∆∞·ªüng doanh s·ªë cho nh√¢n vi√™n kinh doanh t·ª´
                  th√°ng 4/2025.
                </p>
                <div class="notification-footer">
                  <span class="notification-timestamp"
                    >T·∫°o l√∫c: 20/03/2025 09:45</span
                  >
                  <div class="notification-actions">
                    <button class="notification-action-btn primary">
                      Ch·ªânh s·ª≠a
                    </button>
                    <button class="notification-action-btn primary">G·ª≠i</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal for creating new notification - initially hidden -->
    <div id="notification-modal" class="modal-backdrop" style="display: none">
      <div class="modal">
        <div class="modal-header">
          <h3>T·∫°o th√¥ng b√°o m·ªõi</h3>
          <button
            id="close-notification-modal"
            style="background: none; border: none; cursor: pointer"
          >
            <i class="fa fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>Ti√™u ƒë·ªÅ th√¥ng b√°o</label>
            <input
              type="text"
              class="form-control"
              placeholder="Nh·∫≠p ti√™u ƒë·ªÅ th√¥ng b√°o"
            />
          </div>
          <div class="form-group">
            <label>G·ª≠i ƒë·∫øn</label>
            <select class="form-control">
              <option value="all">T·∫•t c·∫£ nh√¢n vi√™n</option>
              <option value="it">Ph√≤ng C√¥ng ngh·ªá th√¥ng tin</option>
              <option value="hr">Ph√≤ng Nh√¢n s·ª±</option>
              <option value="sales">Ph√≤ng Kinh doanh</option>
              <option value="marketing">Ph√≤ng Marketing</option>
            </select>
          </div>
          <div class="form-group">
            <label>N·ªôi dung th√¥ng b√°o</label>
            <textarea
              class="form-control"
              rows="5"
              placeholder="Nh·∫≠p n·ªôi dung th√¥ng b√°o"
            ></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button
            id="save-draft-btn"
            class="btn"
            style="
              background-color: #f8f9fa;
              color: #333;
              border: 1px solid #ddd;
            "
          >
            L∆∞u nh√°p
          </button>
          <button id="send-notification-btn" class="btn">G·ª≠i th√¥ng b√°o</button>
        </div>
      </div>
    </div>

    <script>
      // Handle responsive sidebar
      function handleResponsive() {
        const sidebar = document.querySelector(".sidebar");
        const mainContent = document.querySelector(".main-content");

        if (window.innerWidth <= 768) {
          sidebar.style.width = "70px";
          mainContent.style.marginLeft = "70px";
        } else {
          sidebar.style.width = "250px";
          mainContent.style.marginLeft = "250px";
        }
      }

      // Initial check and on resize
      handleResponsive();
      window.addEventListener("resize", handleResponsive);

      // Tab functionality
      const tabItems = document.querySelectorAll(".tab-item");
      tabItems.forEach((tab) => {
        tab.addEventListener("click", function () {
          // Remove active class from all tabs
          tabItems.forEach((item) => item.classList.remove("active"));
          // Add active class to clicked tab
          this.classList.add("active");

          // In a real app, this would filter notifications based on selected tab
          const tabType = this.getAttribute("data-tab");
          console.log("Selected tab:", tabType);
          filterNotifications(tabType);
        });
      });

      // Function to filter notifications (would be implemented in real app)
      function filterNotifications(type) {
        // This is just a placeholder for demonstration
        // In a real app, this would filter the notifications based on type
        alert(`ƒêang l·ªçc th√¥ng b√°o: ${type}`);
      }

      // Modal handling
      const notificationModal = document.getElementById("notification-modal");
      const createNotificationBtn = document.getElementById(
        "create-notification-btn"
      );
      const closeNotificationModalBtn = document.getElementById(
        "close-notification-modal"
      );
      const saveDraftBtn = document.getElementById("save-draft-btn");
      const sendNotificationBtn = document.getElementById(
        "send-notification-btn"
      );

      function toggleNotificationModal() {
        notificationModal.style.display =
          notificationModal.style.display === "none" ? "flex" : "none";
      }

      createNotificationBtn.addEventListener("click", toggleNotificationModal);
      closeNotificationModalBtn.addEventListener(
        "click",
        toggleNotificationModal
      );

      // Close modal when clicking outside
      notificationModal.addEventListener("click", function (e) {
        if (e.target === this) {
          toggleNotificationModal();
        }
      });

      // Handle save draft button
      saveDraftBtn.addEventListener("click", function () {
        console.log("Saving notification as draft");
        alert("Th√¥ng b√°o ƒë√£ ƒë∆∞·ª£c l∆∞u nh√°p");
        toggleNotificationModal();
      });

      // Handle send notification button
      sendNotificationBtn.addEventListener("click", function () {
        console.log("Sending notification");
        alert("Th√¥ng b√°o ƒë√£ ƒë∆∞·ª£c g·ª≠i");
        toggleNotificationModal();
      });

      // Handle action buttons on notifications
      const actionButtons = document.querySelectorAll(
        ".notification-action-btn"
      );
      actionButtons.forEach((button) => {
        button.addEventListener("click", function () {
          const action = this.textContent.trim();
          console.log("Button clicked:", action);
          alert(`Th·ª±c hi·ªán h√†nh ƒë·ªông: ${action}`);
        });
      });
    </script>
  </body>
</html>
